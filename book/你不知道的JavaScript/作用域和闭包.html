<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>作用域和闭包 | Luooo的博客</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/assets/style.1f90ea4d.css">
    <link rel="modulepreload" href="/assets/app.8a34521a.js">
    <link rel="modulepreload" href="/assets/book_你不知道的JavaScript_作用域和闭包.md.14904366.lean.js">
    
    <link rel="icon" href="/logo.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-e9e9a42c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-45f6ae50></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-45f6ae50> Skip to content </a><!--]--><!----><header class="VPNav" data-v-e9e9a42c data-v-5c4facb3><div class="VPNavBar has-sidebar" data-v-5c4facb3 data-v-3d329d32><div class="container" data-v-3d329d32><div class="VPNavBarTitle has-sidebar" data-v-3d329d32 data-v-51564b70><a class="title" href="/" data-v-51564b70><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" data-v-73ae1788><!--]--><!--[-->Luooo的博客<!--]--><!--[--><!--]--></a></div><div class="content" data-v-3d329d32><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-3d329d32 data-v-a30758ee><span id="main-nav-aria-label" class="visually-hidden" data-v-a30758ee>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/" data-v-a30758ee data-v-8fba5fa8 data-v-f8cd9412><!--[-->博客<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/book/" data-v-a30758ee data-v-8fba5fa8 data-v-f8cd9412><!--[-->书单<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/demo/" data-v-a30758ee data-v-8fba5fa8 data-v-f8cd9412><!--[-->个人项目<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://github.com/cyxbwww/vitepress-blog" target="_blank" rel="noreferrer" data-v-a30758ee data-v-8fba5fa8 data-v-f8cd9412><!--[-->GitHub<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://juejin.cn/user/2058727243123982/posts" target="_blank" rel="noreferrer" data-v-a30758ee data-v-8fba5fa8 data-v-f8cd9412><!--[-->掘金<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-3d329d32 data-v-311055f2><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-311055f2 data-v-781f9d1b data-v-1dda4c9c><span class="check" data-v-1dda4c9c><span class="icon" data-v-1dda4c9c><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-781f9d1b><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-781f9d1b><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-3d329d32 data-v-0562f5c0 data-v-7a4cc9c2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-7a4cc9c2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-7a4cc9c2><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-7a4cc9c2><div class="VPMenu" data-v-7a4cc9c2 data-v-1c05de92><!----><!--[--><!--[--><!----><div class="group" data-v-0562f5c0><div class="item appearance" data-v-0562f5c0><p class="label" data-v-0562f5c0>Appearance</p><div class="appearance-action" data-v-0562f5c0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-0562f5c0 data-v-781f9d1b data-v-1dda4c9c><span class="check" data-v-1dda4c9c><span class="icon" data-v-1dda4c9c><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-781f9d1b><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-781f9d1b><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-3d329d32 data-v-acede866><span class="container" data-v-acede866><span class="top" data-v-acede866></span><span class="middle" data-v-acede866></span><span class="bottom" data-v-acede866></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-e9e9a42c data-v-92b0f14a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-92b0f14a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-92b0f14a><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-92b0f14a>Menu</span></button><a class="top-link" href="#" data-v-92b0f14a> Return to top </a></div><aside class="VPSidebar" data-v-e9e9a42c data-v-225de096><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-225de096><span class="visually-hidden" id="sidebar-aria-label" data-v-225de096> Sidebar Navigation </span><!--[--><div class="group" data-v-225de096><section class="VPSidebarGroup collapsible" data-v-225de096 data-v-385de926><div class="title" role="button" data-v-385de926><h2 class="title-text" data-v-385de926>你不知道的JavaScript</h2><div class="action" data-v-385de926><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-385de926><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-385de926><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-385de926><!--[--><a class="VPLink link link active" href="/book/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript/%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>作用域和闭包</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript/this%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%8E%9F%E5%9E%8B.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>this和对象原型</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript/%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%AF%AD%E6%B3%95.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>类型和语法</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript/%E5%BC%82%E6%AD%A5%E5%92%8C%E6%80%A7%E8%83%BD.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>异步和性能</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-225de096><section class="VPSidebarGroup collapsible collapsed" data-v-225de096 data-v-385de926><div class="title" role="button" data-v-385de926><h2 class="title-text" data-v-385de926>Vue.js设计与实现</h2><div class="action" data-v-385de926><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-385de926><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-385de926><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-385de926><!--[--><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%A7%88.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>框架设计概览</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E5%93%8D%E5%BA%94%E7%B3%BB%E7%BB%9F.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>响应系统</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E6%B8%B2%E6%9F%93%E5%99%A8.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>渲染器</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E7%BB%84%E4%BB%B6%E5%8C%96.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>组件化</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E7%BC%96%E8%AF%91%E5%99%A8.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>编译器</span><!----><!--]--><!----></a><a class="VPLink link link" href="/book/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93.html" data-v-385de926 data-v-72c8178a data-v-f8cd9412><!--[--><span class="link-text" data-v-72c8178a>服务端渲染</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-e9e9a42c data-v-0c28dd2e><div class="VPDoc has-sidebar has-aside" data-v-0c28dd2e data-v-e8c58d34><div class="container" data-v-e8c58d34><div class="aside" data-v-e8c58d34><div class="aside-curtain" data-v-e8c58d34></div><div class="aside-container" data-v-e8c58d34><div class="aside-content" data-v-e8c58d34><div class="VPDocAside" data-v-e8c58d34 data-v-779d834d><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-779d834d data-v-62402d0e><div class="content" data-v-62402d0e><div class="outline-marker" data-v-62402d0e></div><div class="outline-title" data-v-62402d0e>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-62402d0e><span class="visually-hidden" id="doc-outline-aria-label" data-v-62402d0e> Table of Contents for current page </span><ul class="root" data-v-62402d0e><!--[--><li style="" data-v-62402d0e><a class="outline-link" href="#_1-作用域是什么" data-v-62402d0e>1. 作用域是什么</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-779d834d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e8c58d34><div class="content-container" data-v-e8c58d34><!--[--><!--]--><main class="main" data-v-e8c58d34><div style="position:relative;" class="vp-doc _book_%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript_%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85" data-v-e8c58d34><div><h1 id="作用域和闭包" tabindex="-1">作用域和闭包 <a class="header-anchor" href="#作用域和闭包" aria-hidden="true">#</a></h1><h2 id="_1-作用域是什么" tabindex="-1">1. 作用域是什么 <a class="header-anchor" href="#_1-作用域是什么" aria-hidden="true">#</a></h2><h3 id="_1-1-编译原理" tabindex="-1">1.1 编译原理 <a class="header-anchor" href="#_1-1-编译原理" aria-hidden="true">#</a></h3><p>在传统编译语言的流程中，程序的一段源代码在执行之前会经历三个步骤统称为“编译”。</p><ul><li><p>分词/词法分析（ Tokenizing/Lexing ）</p><p>这个过程会将由字符组成的字符串分解成（对编程语言来说）有意义的代码块，这些代码块被称为词法单元（ token ）。</p></li><li><p>解析/语法分析（ Parsing ）</p><p>这个过程是将词法单元流（数组）转换成一个由元素逐级嵌套所组成的代表了程序语法结构的树。这个树被称为“抽象语法树”（ Abstract Syntax Tree，AST ）。</p></li><li><p>代码生成</p><p>将 AST 转换为可执行代码的过程被称为代码生成。这个过程与语言、目标平台等息息相关。</p></li></ul><p>相比一些只有三个步骤的语言的编译器，JavaScript 引擎要复杂得多。例如，在语法分析和代码生成阶段有特定的步骤来对运行性能进行优化，包括对冗余元素进行优化等。</p><p>JavaScript 引擎不会有大量的时间用来进行优化，因为与其它语言不同，JavaScript 的编译过程不是发生在构建之前的。</p><p>对于 JavaScript 来说大部分情况编译发生在代码执行的前几微秒的时间内。在作用域背后 JavaScript 引擎用尽了各种方法来保证性能最佳。</p><p>简单来说，任何 JavaScript 代码片段在执行前都要进行编译（通常就在执行前）。</p><h3 id="_1-2-理解作用域" tabindex="-1">1.2 理解作用域 <a class="header-anchor" href="#_1-2-理解作用域" aria-hidden="true">#</a></h3><p>我们将学习作用域的过程模拟成几个人物之间的对话。</p><h4 id="_1-2-1-演员表" tabindex="-1">1.2.1 演员表 <a class="header-anchor" href="#_1-2-1-演员表" aria-hidden="true">#</a></h4><p>对程序 <code>var a = 2;</code> 进行处理为例。</p><ul><li><p>引擎</p><p>从头到尾负责整个 JavaScript 程序的编译及执行过程。</p></li><li><p>编译器</p><p>引擎的好朋友之一，负责语法分析及代码生成等脏活累活（如前一节的内容）。</p></li><li><p>作用域</p><p>引擎的另一位好朋友，负责收集并维护由所有声明的标识符（变量）组成的一系列查询，并实施一套非常严格的规则，确定当前执行代码对这些标识符的访问权限。</p></li></ul><h4 id="_1-2-2-对话" tabindex="-1">1.2.2 对话 <a class="header-anchor" href="#_1-2-2-对话" aria-hidden="true">#</a></h4><p>当看见 <code>var a = 2;</code> 这段程序时，很可能认为这是一句声明。事实上引擎认为这里有两个完全不同的声明，一个由编译器在编译时处理，另一个则由引擎在运行时处理。</p><p>可以合理地假设编译器所产生地代码能够用下面的伪代码进行概括：“为一个变量分配内存，将其命名为 <code>a</code>，然后将值 2 保存进这个变量”。这里并不完全准确。实际编译器会进行如下处理：</p><ol><li>遇到 <code>var a</code>，编译器询问作用域是否有一个该名称的变量存在于同一个作用域的集合中。如果是，编译器会忽略该声明，继续进行编译；否则它会要求作用域在当前作用域的集合中声明一个新的变量，并命名为 <code>a</code>。</li><li>接下来编译器会为引擎生成运行时的代码，这些代码被用来处理 <code>a = 2</code>这个赋值操作。引擎运行时会首先询问作用域，在当前的作用域集合中是否存在一个叫做 <code>a</code> 的变量。如果是，引擎就会使用这个变量；如果否，引擎会继续查找该变量。</li></ol><p>如果引擎最终找到了 <code>a</code> 变量，就会将 2 赋值给它。否则引擎会抛出一个异常。</p><p><strong>总结</strong>：变量的赋值操作会执行两个动作，首先编译器会在当前作用域中声明一个变量（如果之前没声明过），然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它赋值。</p><h4 id="_1-2-3-编译器有话说" tabindex="-1">1.2.3 编译器有话说 <a class="header-anchor" href="#_1-2-3-编译器有话说" aria-hidden="true">#</a></h4><p>编译器在编译过程的第二步中生成了代码，引擎执行它时，会通过查找变量 <code>a</code> 来判断它是否已声明过。查找的过程由作用域进行协助，在我们的例子中，引擎会为变量 <code>a</code> 进行 LHS 查询。另外一个查找的类型叫作 LRS。</p><p>以下代码对 <code>a</code> 的引用是一个 RHS 引用，因为这里 <code>a</code> 没有赋予任何值，且需要查找并取得 <code>a</code> 的值。</p><div class="language-javascript"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(a)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>相比以下代码对 <code>a</code> 的引用是一个 LHS 引用，我们不关心当前值是什么，只是想要为 <code>= 2</code> 这个赋值操作找到一个目标。</p><div class="language-javascript"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#A6ACCD;">a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>LHS 和 RHS 的含义是“赋值操作的左侧和右侧”并不一定意味着“ <code>=</code> 赋值操作符的左侧或右侧”。赋值操作还有其它几种形式，因此在概念上最好将其理解为“赋值操作的目标是谁（ LHS ）”以及“谁是赋值操作的源头（ RHS ）”。</p></blockquote><p>下面的程序中，既有 LHS 也有 RHS 引用：</p><div class="language-javascript"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 隐式的 a = 2，进行一次 LHS 查询，</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 并对 a 进行 RHS 引用传递给 console.log</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 对 console 进行 RHS 引用，</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 并检查得到的值是否有一个叫作 log 的方法</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 再次对 a 进行 RHS 引用</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#82AAFF;">foo</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 对 foo 进行 RHS 引用并执行</span></span>
<span class="line"></span></code></pre></div><h4 id="_1-2-4-引擎和作用域的对话" tabindex="-1">1.2.4 引擎和作用域的对话 <a class="header-anchor" href="#_1-2-4-引擎和作用域的对话" aria-hidden="true">#</a></h4><p>我们把上一节的代码处理过程想象成一段对话，这段对话可能是下面这样：</p><div class="language-text"><button class="copy"></button><span class="lang">text</span><pre><code><span class="line"><span style="color:#A6ACCD;">引擎：我说作用域，我需要为 foo 进行 RHS 引用。你见过它吗？</span></span>
<span class="line"><span style="color:#A6ACCD;">作用域：别说，我还真见过，编译器那小子刚刚声明了它。它是一个函数，给你。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：哥们太够意思了！好吧，我来执行一下 foo。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：作用域，还有个事儿。我需要为 a 进行 LHS 引用，这个你见过吗？</span></span>
<span class="line"><span style="color:#A6ACCD;">作用域：这个也见过，编译器最近把它声明为 foo 的一个形式参数了，拿去吧。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：大恩不言谢，你总是那么棒。现在我要把 2 赋值给 a。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：哥们，不好意思又来打扰你。我要为 console 进行 RHS 引用，你见过它吗？</span></span>
<span class="line"><span style="color:#A6ACCD;">作用域：咋俩谁跟谁啊，再说我就是干这个的。这个我也有，console 是个内置对象，给你。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：么么哒。我得看看里面是不是有log()。太好了，找到了，是一个函数。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：哥们，能帮我再找一下 对 a 的 RHS 引用吗？虽然我记得它，但想再确认一次。</span></span>
<span class="line"><span style="color:#A6ACCD;">作用域：放心吧，这个变量没有变动过，拿走，不谢。</span></span>
<span class="line"><span style="color:#A6ACCD;">引擎：真棒。我来把 a 的值，也就是 2，传递进 log()。</span></span>
<span class="line"><span style="color:#A6ACCD;">......</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h4 id="_1-2-5-小测验" tabindex="-1">1.2.5 小测验 <a class="header-anchor" href="#_1-2-5-小测验" aria-hidden="true">#</a></h4><p>检验一下到目前的理解程度。把自己当作引擎，并同作用域进行一次“对话”“：</p><div class="language-javascript"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 隐式的 a = 2，进行 LHS 查询</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 对 b 进行 LHS 查询</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 对 a 进行 RHS 引用</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">b</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 对 a 进行 RHS 引用</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 对 b 进行 RHS 引用</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">a</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// c = ..，对 c 进行 LHS 查询</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对 foo 进行 RHS 引用</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> c </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-e8c58d34 data-v-07504af8><div class="edit-info" data-v-07504af8><!----><div class="last-updated" data-v-07504af8><p class="VPLastUpdated" data-v-07504af8 data-v-6e407d7f>最近更新时间: <time datatime="2022-12-04T07:29:38.000Z" data-v-6e407d7f></time></p></div></div><div class="prev-next" data-v-07504af8><div class="pager" data-v-07504af8><!----></div><div class="pager" data-v-07504af8><a class="pager-link next" href="/book/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript/this%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%8E%9F%E5%9E%8B.html" data-v-07504af8><span class="desc" data-v-07504af8>下一页</span><span class="title" data-v-07504af8>this和对象原型</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"blog_eggjs_基础.md\":\"b55dc409\",\"blog_index.md\":\"338152b6\",\"blog_javascript_map和set.md\":\"caeb8efd\",\"blog_javascript_代理与反射.md\":\"f1647133\",\"blog_javascript_代理捕获器与反射方法.md\":\"6f52f793\",\"blog_javascript_函数.md\":\"952173f8\",\"blog_javascript_对象.md\":\"22737e0e\",\"blog_javascript_对象内置方法.md\":\"0493736d\",\"blog_javascript_属性标志和属性描述符.md\":\"0a027d98\",\"blog_javascript_异步函数.md\":\"15b94b62\",\"blog_javascript_数组.md\":\"7e1576ff\",\"blog_javascript_数组内置方法.md\":\"491333ce\",\"blog_javascript_期约.md\":\"0227bc55\",\"blog_javascript_生成器.md\":\"6b2c7d47\",\"blog_javascript_迭代器.md\":\"a04c6f96\",\"blog_nestjs_基础.md\":\"9a3448ce\",\"blog_npm_npm包开发.md\":\"1f161721\",\"blog_npm_package.md\":\"b1d5c382\",\"blog_npm_介绍.md\":\"edc1d9ab\",\"blog_typescript_symbols.md\":\"e4ce5f92\",\"blog_typescript_函数.md\":\"bfdf5448\",\"blog_typescript_变量声明.md\":\"4b628238\",\"blog_typescript_命名空间.md\":\"5d7a04da\",\"blog_typescript_基础类型.md\":\"2456a82f\",\"blog_typescript_声明合并.md\":\"c857f419\",\"blog_typescript_接口.md\":\"92c1af97\",\"blog_typescript_枚举.md\":\"b582d74d\",\"blog_typescript_模块.md\":\"bcc38f07\",\"blog_typescript_泛型.md\":\"b27ad56c\",\"blog_typescript_类.md\":\"aa785eb3\",\"blog_typescript_类型兼容性.md\":\"eda2291e\",\"blog_typescript_类型推论.md\":\"99e559db\",\"blog_typescript_迭代器和生成器.md\":\"3abf24a4\",\"blog_typescript_高级类型.md\":\"1af9faf5\",\"blog_vue_全局api.md\":\"455f50e8\",\"blog_vue_内置内容.md\":\"bb2aaa70\",\"blog_vue_单文件组件.md\":\"02a66bc6\",\"blog_vue_组合式api.md\":\"d622e4d3\",\"blog_vue_进阶api.md\":\"3c0a6bcf\",\"blog_vue_选项式api.md\":\"5c0ab718\",\"book_vue.js设计与实现_响应系统.md\":\"ae62d184\",\"book_vue.js设计与实现_服务端渲染.md\":\"9396534f\",\"book_vue.js设计与实现_框架设计概览.md\":\"f8afc56a\",\"book_vue.js设计与实现_渲染器.md\":\"96d0343c\",\"book_vue.js设计与实现_组件化.md\":\"01f5067a\",\"book_vue.js设计与实现_编译器.md\":\"c5be9696\",\"book_index.md\":\"f76de289\",\"book_你不知道的javascript_this和对象原型.md\":\"9f775494\",\"book_你不知道的javascript_作用域和闭包.md\":\"14904366\",\"book_你不知道的javascript_异步和性能.md\":\"f2a52d11\",\"book_你不知道的javascript_类型和语法.md\":\"886f0c4f\",\"demo_index.md\":\"8736e61f\",\"demo_博客管理系统前端项目（vue.js）_目录说明.md\":\"76ea949d\",\"demo_博客管理系统前端项目（vue.js）_项目搭建.md\":\"13ace920\",\"demo_博客管理系统后端项目（egg.js）_目录说明.md\":\"0267a430\",\"demo_博客管理系统后端项目（egg.js）_项目搭建.md\":\"52379ae3\",\"demo_博客管理系统后端项目（nest.js）_目录说明.md\":\"a068686e\",\"demo_博客管理系统后端项目（nest.js）_项目搭建.md\":\"b54157d0\",\"index.md\":\"fcbca95a\"}")</script>
    <script type="module" async src="/assets/app.8a34521a.js"></script>
    
  </body>
</html>