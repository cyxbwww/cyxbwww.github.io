# 数组

## splice

添加、删除、替换元素，返回被修改内容，会改变原数组。

``` javascript
const arr = ['welcome', 'to', 'my', 'blog'];

// 从索引 0 的位置开始删除所有元素
arr.splice(0);

// 从索引 1 的位置开始删除 1 个元素
arr.splice(1, 2);

// 从索引 2 的位置开始删除 1 个元素，插入 “this”
arr.splice(2, 1 , 'this');

// 从索引 -1 的位置开始删除 1 个元素
arr.splice(-1, 1);
```

## slice

浅复制元素，返回新数组，不改变原数组。

``` javascript
const arr = ['t', 'e', 's', 't'];

// 复制从索引 1 到索引 3 的元素
arr.slice(1, 3);

// 复制从索引 -2 到尾端的元素
arr.slice(-2);
```

## reduce

对数组中的每个元素按序执行函数，每一次运行会将先前元素的计算结果作为参数传入，最后将其结果汇总为单个返回值。

### 求数组中所有值的和

``` javascript
const arr = [0, 1, 2, 3];

arr.reduce((sum, num) => sum + num, 0);

// 6
```

### 计算数组中每个元素出现的次数

``` javascript
const arr = ['Alice', 'Bob', 'Tiff', 'Bruce', 'Alice'];

arr.reduce((allNames, name) => {
  if (name in allNames) {
    allNames[name]++;
  } else {
    allNames[name] = 1;
  }
  return allNames;
}, {});

// { Alice: 2, Bob: 1, Tiff: 1, Bruce: 1 }
```

### 按属性分类

``` javascript
const arr = [
  { name: 'Alice', age: 21 },
  { name: 'Max', age: 20 },
  { name: 'Jane', age: 20 }
];

arr.reduce((acc, obj) => {
  const key = obj['age'];
    
  if (!acc[key]) {
    acc[key] = [];
  }
  acc[key].push(obj);
    
  return acc;
}, {});

// {
//   20: [{name: 'Max', age: 20}, {name: 'Jane', age: 20}],
//   21: [{name: 'Alice', age: 21}]
// }
```

## indexOf

返回给定元素的第一个索引，如果不存在，则返回-1。

``` javascript
const arr = [2, 5, 9];

arr.indexOf(2); // 0
arr.indexOf(7); // -1
arr.indexOf(9, 2);  // 2
arr.indexOf(2, -1); // -1
arr.indexOf(2, -3); // 0
```

### 找出指定元素出现的所有位置

``` javascript
const indices = [];
const arr = ['a', 'b', 'a', 'c', 'a', 'd'];
let idx = arr.indexOf('a');

while (idx !== -1) {
  indices.push(idx);
  idx = arr.indexOf('a', idx + 1);
}

console.log(indices); // [0, 2, 4]
```

## includes

判断一个数组是否包含一个指定的值，根据情况，如果包含则返回 `true`，否则返回 `false`。

``` javascript
const arr = [1, 2, 3, NaN];

arr.includes(2); // true
arr.includes(4); // false
arr.includes(3, 3); // false
arr.includes(3, -2); // true
arr.includes(NaN); // true
```

## find

返回数组中满足提供函数的第一个元素的值，否则返回 `undefined`。

### 用对象的属性查找数组里的对象

``` javascript
const arr = [
  { name: 'apples', quantity: 2 },
  { name: 'bananas', quantity: 0 },
  { name: 'cherries', quantity: 5 },
];

// { name: 'bananas', quantity: 0 }
arr.find(v => v.name === 'bananas');
```

### 寻找数组中的质数

``` javascript
const arr = [4, 5, 8, 12];

arr.find(v => {
  let start = 2;
  while (start <= Math.sqrt(v)) {
    if (v % start++ < 1) {
      return false;
    }
  }
  return v > 1;
}) // 5
```

## filter

创建一个新数组，包含通过所提供函数的所有元素，返回新数组。

### 筛选排除所有较小的值

``` javascript
const arr = [12, 5, 8, 130, 44];

// [12, 130, 44]
arr.filter(v => v >= 10);
```

### 在数组中搜索

``` javascript
const arr = ['apple', 'banana', 'grapes', 'mango', 'orange'];

// ['apple', 'grapes']
arr.filter(v => v.toLowerCase().indexOf('ap'.toLowerCase()) > -1);
```

## forEach

遍历数组，调用 `forEach` 后添加到数组的项不会被访问到，总是返回 `undefined` ，不可链式调用。

> 除了抛出异常外，没有办法可以中止或跳出 `foreach` 循环。

### 不对未初始化的值进行任何操作（稀疏数组）

``` javascript
const arr = [1, 3, , 7];
let count = 0;

arr.forEach((element) => {
  console.log(element);
  count++;
});

console.log('count:', count);

// 1
// 3
// 7
// count: 3
```

### 扁平化数组

> 使用内置方法来扁平化数组可以考虑使用 flat()

``` javascript
function flatten(arr) {
  const result = []

  arr.forEach((i) => {
    if (Array.isArray(i)) {
      result.push(...flatten(i))
    } else {
      result.push(i)
    }
  })

  return result
}

const arr = [1, 2, 3, [4, 5, [6, 7], 8, 9]]

flatten(arr) // [1, 2, 3, 4, 5, 6, 7, 8, 9]
```

## map

创建一个新数组，这个新数组由原数组中的每个元素都调用一次提供的函数后的返回值组成。

### 求数组中每个元素的平方根

``` javascript
const arr = [1, 4, 9];

// [1, 2, 3]
arr.map(Math.sqrt);
```

### 重新格式化数组中的对象

``` javascript
const arr = [
  { key: 1, value: 10 },
  { key: 2, value: 20 },
  { key: 3, value: 30 }
];

// [
//   { "1": 10 },
//   { "2": 20 },
//   { "3": 30 }
// ]
arr.map(v => {
  const obj = {};
  obj[v.key] = v.value;
    
  return obj;
});
```

